module.exports = class Data1669968710634 {
    name = 'Data1669968710634'

    async up(db) {
        await db.query(`ALTER TABLE "token_holder" DROP CONSTRAINT "FK_71eb8d693bdefe207789b202b0a"`)
        await db.query(`ALTER TABLE "contract" DROP CONSTRAINT "FK_d545d6a232eb5d8e4603c442b14"`)
        await db.query(`DROP INDEX "public"."IDX_71eb8d693bdefe207789b202b0"`)
        await db.query(`DROP INDEX "public"."IDX_2a48612cabfbb542a1566ac1a2"`)
        await db.query(`DROP INDEX "public"."IDX_7fe874cfbdd2ec8578c03f789c"`)
        await db.query(`DROP INDEX "public"."IDX_d545d6a232eb5d8e4603c442b1"`)
        await db.query(`DROP INDEX "public"."IDX_0c05159e500e0de38327f51cdc"`)
        await db.query(`DROP INDEX "public"."IDX_22bbd4c1019b6727a8c0660b87"`)
        await db.query(`CREATE TABLE "block" ("id" character varying NOT NULL, "hash" text NOT NULL, "author" text NOT NULL, "state_root" text NOT NULL, "parent_hash" text NOT NULL, "extrinsic_root" text NOT NULL, "finalized" boolean NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "processor_timestamp" TIMESTAMP WITH TIME ZONE, CONSTRAINT "PK_d0925763efb591c2e2ffb267572" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_f8fba63d7965bfee9f304c487a" ON "block" ("hash") `)
        await db.query(`CREATE INDEX "IDX_97862dcc0742e14c96127c78b1" ON "block" ("finalized") `)
        await db.query(`ALTER TABLE "token_holder" DROP COLUMN "signer"`)
        await db.query(`ALTER TABLE "token_holder" DROP COLUMN "signer_id_id"`)
        await db.query(`ALTER TABLE "contract" DROP COLUMN "signer"`)
        await db.query(`ALTER TABLE "contract" DROP COLUMN "signer_id_id"`)
        await db.query(`ALTER TABLE "token_holder" ADD "signer_address" text`)
        await db.query(`ALTER TABLE "token_holder" ADD "signer_id" character varying`)
        await db.query(`ALTER TABLE "contract" ADD "signer_address" text`)
        await db.query(`ALTER TABLE "contract" ADD "signer_id" character varying`)
        await db.query(`CREATE INDEX "IDX_77bdccde4b3585013306c3606f" ON "token_holder" ("signer_id") `)
        await db.query(`CREATE INDEX "IDX_c79383642c0cdd9ba43f20d665" ON "token_holder" ("signer_address") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_cb611c881df7d7590537a0e7c9" ON "token_holder" ("token_address", "signer_id", "nft_id") `)
        await db.query(`CREATE INDEX "IDX_c36378dd820dcbc9e74e71fe24" ON "contract" ("signer_id") `)
        await db.query(`CREATE INDEX "IDX_2735e3a083c2ebe8b714bda2af" ON "contract" ("signer_address") `)
        await db.query(`CREATE INDEX "IDX_22bbd4c1019b6727a8c0660b87" ON "account" ("evm_address") `)
        await db.query(`ALTER TABLE "token_holder" ADD CONSTRAINT "FK_77bdccde4b3585013306c3606fc" FOREIGN KEY ("signer_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "contract" ADD CONSTRAINT "FK_c36378dd820dcbc9e74e71fe24d" FOREIGN KEY ("signer_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`ALTER TABLE "token_holder" ADD CONSTRAINT "FK_71eb8d693bdefe207789b202b0a" FOREIGN KEY ("signer_id_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "contract" ADD CONSTRAINT "FK_d545d6a232eb5d8e4603c442b14" FOREIGN KEY ("signer_id_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`CREATE INDEX "IDX_71eb8d693bdefe207789b202b0" ON "token_holder" ("signer_id_id") `)
        await db.query(`CREATE INDEX "IDX_2a48612cabfbb542a1566ac1a2" ON "token_holder" ("signer") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_7fe874cfbdd2ec8578c03f789c" ON "token_holder" ("token_address", "signer", "nft_id") `)
        await db.query(`CREATE INDEX "IDX_d545d6a232eb5d8e4603c442b1" ON "contract" ("signer_id_id") `)
        await db.query(`CREATE INDEX "IDX_0c05159e500e0de38327f51cdc" ON "contract" ("signer") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_22bbd4c1019b6727a8c0660b87" ON "account" ("evm_address") `)
        await db.query(`DROP TABLE "block"`)
        await db.query(`DROP INDEX "public"."IDX_f8fba63d7965bfee9f304c487a"`)
        await db.query(`DROP INDEX "public"."IDX_97862dcc0742e14c96127c78b1"`)
        await db.query(`ALTER TABLE "token_holder" ADD "signer" text`)
        await db.query(`ALTER TABLE "token_holder" ADD "signer_id_id" character varying`)
        await db.query(`ALTER TABLE "contract" ADD "signer" text`)
        await db.query(`ALTER TABLE "contract" ADD "signer_id_id" character varying`)
        await db.query(`ALTER TABLE "token_holder" DROP COLUMN "signer_address"`)
        await db.query(`ALTER TABLE "token_holder" DROP COLUMN "signer_id"`)
        await db.query(`ALTER TABLE "contract" DROP COLUMN "signer_address"`)
        await db.query(`ALTER TABLE "contract" DROP COLUMN "signer_id"`)
        await db.query(`DROP INDEX "public"."IDX_77bdccde4b3585013306c3606f"`)
        await db.query(`DROP INDEX "public"."IDX_c79383642c0cdd9ba43f20d665"`)
        await db.query(`DROP INDEX "public"."IDX_cb611c881df7d7590537a0e7c9"`)
        await db.query(`DROP INDEX "public"."IDX_c36378dd820dcbc9e74e71fe24"`)
        await db.query(`DROP INDEX "public"."IDX_2735e3a083c2ebe8b714bda2af"`)
        await db.query(`DROP INDEX "public"."IDX_22bbd4c1019b6727a8c0660b87"`)
        await db.query(`ALTER TABLE "token_holder" DROP CONSTRAINT "FK_77bdccde4b3585013306c3606fc"`)
        await db.query(`ALTER TABLE "contract" DROP CONSTRAINT "FK_c36378dd820dcbc9e74e71fe24d"`)
    }
}
